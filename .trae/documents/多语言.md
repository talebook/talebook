在 Nuxt 4 项目中实现多语言，推荐使用 `@nuxtjs/i18n` 模块。以下是完整实现步骤：

## 1. 安装依赖

```bash
npm install @nuxtjs/i18n
```

## 2. 配置 Nuxt 配置

在 `nuxt.config.ts` 中添加配置：

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  modules: [
    '@nuxtjs/i18n'
  ],
  
  i18n: {
    // 策略配置
    strategy: 'prefix_except_default', // 可选: 'prefix', 'prefix_except_default', 'prefix_and_default', 'no_prefix'
    defaultLocale: 'zh-CN', // 默认语言
    locales: [
      {
        code: 'zh-CN',
        name: '简体中文',
        iso: 'zh-CN',
        file: 'zh-CN.json'
      },
      {
        code: 'en-US',
        name: 'English (US)', 
        iso: 'en-US',
        file: 'en-US.json'
      }
    ],
    
    // 语言文件目录
    langDir: 'locales/',
    
    // 检测浏览器语言并重定向
    detectBrowserLanguage: {
      useCookie: true,
      cookieKey: 'i18n_redirected',
      redirectOn: 'root', // 在根路径检测并重定向
      alwaysRedirect: false
    },
    
    // Vue I18n 配置
    vueI18n: './i18n.config.ts'
  }
})
```

## 3. 创建语言文件目录和文件

创建 `locales/` 目录和语言文件：

```bash
mkdir -p locales
```

### 中文文件 `locales/zh-CN.json`:
```json
{
  "common": {
    "welcome": "欢迎使用",
    "home": "首页",
    "about": "关于",
    "contact": "联系我们",
    "login": "登录",
    "logout": "退出",
    "save": "保存",
    "cancel": "取消",
    "loading": "加载中..."
  },
  "book": {
    "title": "书籍",
    "author": "作者",
    "publisher": "出版社",
    "import": "导入书籍",
    "scan": "扫描书籍",
    "delete": "删除"
  },
  "opds": {
    "import": "从 OPDS 导入",
    "host": "主机地址",
    "port": "端口",
    "path": "路径",
    "connect": "连接",
    "browse": "浏览目录",
    "select": "选择书籍",
    "importing": "正在导入..."
  },
  "errors": {
    "required": "此字段必填",
    "invalidUrl": "无效的 URL 地址",
    "connectionFailed": "连接失败"
  }
}
```

### 英文文件 `locales/en-US.json`:
```json
{
  "common": {
    "welcome": "Welcome",
    "home": "Home",
    "about": "About",
    "contact": "Contact",
    "login": "Login",
    "logout": "Logout",
    "save": "Save",
    "cancel": "Cancel",
    "loading": "Loading..."
  },
  "book": {
    "title": "Book",
    "author": "Author",
    "publisher": "Publisher",
    "import": "Import Books",
    "scan": "Scan Books",
    "delete": "Delete"
  },
  "opds": {
    "import": "Import from OPDS",
    "host": "Host Address",
    "port": "Port",
    "path": "Path",
    "connect": "Connect",
    "browse": "Browse Directory",
    "select": "Select Books",
    "importing": "Importing..."
  },
  "errors": {
    "required": "This field is required",
    "invalidUrl": "Invalid URL address",
    "connectionFailed": "Connection failed"
  }
}
```

## 4. 创建 Vue I18n 配置文件

创建 `i18n.config.ts`:

```typescript
// i18n.config.ts
export default defineI18nConfig(() => ({
  legacy: false,
  locale: 'zh',
  messages: {
    // 这里可以放置默认消息或动态加载
  },
  
  // 日期时间格式化
  datetimeFormats: {
    'zh': {
      short: {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
      },
      long: {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        weekday: 'long',
        hour: 'numeric',
        minute: 'numeric'
      }
    },
    'en': {
      short: {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
      },
      long: {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        weekday: 'long',
        hour: 'numeric',
        minute: 'numeric',
        hour12: true
      }
    }
  },
  
  // 数字格式化
  numberFormats: {
    'zh': {
      currency: {
        style: 'currency',
        currency: 'CNY'
      }
    },
    'en': {
      currency: {
        style: 'currency',
        currency: 'USD'
      }
    }
  }
}))
```

## 5. 在组件中使用

### Composition API 方式：
```vue
<template>
  <div>
    <h1>{{ $t('common.welcome') }}</h1>
    <p>{{ $t('book.import') }}</p>
    
    <form>
      <label>{{ $t('opds.host') }}:</label>
      <input :placeholder="$t('opds.host')" />
      
      <button @click="connect">
        {{ $t('opds.connect') }}
      </button>
    </form>
    
    <!-- 语言切换器 -->
    <div class="language-switcher">
      <button @click="setLocale('zh')">中文</button>
      <button @click="setLocale('en')">English</button>
    </div>
    
    <!-- 显示当前语言 -->
    <p>当前语言: {{ currentLocale }}</p>
  </div>
</template>

<script setup>
import { useI18n } from '#i18n'

const { t, locale, setLocale } = useI18n()

const currentLocale = computed(() => locale.value)

const connect = () => {
  console.log(t('opds.connecting'))
}
</script>
```

### Options API 方式：
```vue
<template>
  <div>
    <h1>{{ $t('common.welcome') }}</h1>
  </div>
</template>

<script>
export default {
  computed: {
    currentLocale() {
      return this.$i18n.locale
    }
  },
  methods: {
    changeLanguage(lang) {
      this.$i18n.setLocale(lang)
    }
  }
}
</script>
```

## 6. 服务器端使用

在 API 路由或服务器中间件中使用：

```typescript
// server/api/books.get.ts
export default defineEventHandler(async (event) => {
  // 获取当前语言
  const locale = getHeader(event, 'accept-language') || 'zh'
  
  // 根据语言返回不同内容
  const messages = {
    zh: { title: '书籍列表' },
    en: { title: 'Book List' }
  }
  
  return {
    title: messages[locale]?.title || messages.zh.title,
    books: []
  }
})
```

## 7. 添加语言切换组件

创建 `components/LanguageSwitcher.vue`:

```vue
<template>
  <div class="language-switcher">
    <v-menu>
      <template #activator="{ props }">
        <v-btn v-bind="props" variant="text">
          <v-icon>mdi-translate</v-icon>
          {{ currentLanguageName }}
          <v-icon>mdi-chevron-down</v-icon>
        </v-btn>
      </template>
      
      <v-list>
        <v-list-item
          v-for="locale in availableLocales"
          :key="locale.code"
          @click="setLocale(locale.code)"
        >
          <v-list-item-title>{{ locale.name }}</v-list-item-title>
        </v-list-item>
      </v-list>
    </v-menu>
  </div>
</template>

<script setup>
import { useI18n } from '#i18n'

const { locales, locale, setLocale } = useI18n()

const availableLocales = computed(() => {
  return (locales.value || []).filter(i => i.code !== locale.value)
})

const currentLanguageName = computed(() => {
  const current = (locales.value || []).find(i => i.code === locale.value)
  return current?.name || locale.value
})
</script>

<style scoped>
.language-switcher {
  display: inline-block;
}
</style>
```

## 8. 路由和 SEO 配置

### 自动路由前缀（基于配置的 strategy）：
- `/` - 默认语言（中文）
- `/en` - 英文

### SEO 优化：
```vue
<template>
  <div>
    <Head>
      <Title>{{ $t('seo.title') }}</Title>
      <Meta name="description" :content="$t('seo.description')" />
    </Head>
    <!-- 页面内容 -->
  </div>
</template>
```

## 9. 高级功能

### 动态导入语言文件：
```typescript
// i18n.config.ts
export default defineI18nConfig(() => ({
  // 使用动态导入
  lazy: true,
  langDir: 'locales',
  locales: [
    { code: 'zh', file: 'zh-CN.json' },
    { code: 'en', file: 'en-US.json' }
  ]
}))
```

### 命名空间：
```json
// locales/zh-CN/book.json
{
  "title": "书籍",
  "import": "导入"
}

// 使用
$t('book.title')
```

### 复数形式：
```json
{
  "book": {
    "book_one": "1本书",
    "book_other": "{count}本书"
  }
}

// 使用
$t('book.book', { count: 5 }) // 5本书
```

## 10. 测试多语言

```bash
# 访问不同语言版本
http://localhost:3000        # 中文
http://localhost:3000/en     # 英文
```

## 注意事项

1. **确保所有文本都使用 `$t()`** 而不是硬编码
2. **测试所有语言版本的布局**，有些语言文本可能较长
3. **考虑RTL语言**（如阿拉伯语）的布局支持
4. **性能优化**：使用懒加载语言文件
5. **保持翻译一致性**：使用相同的术语表

## 推荐工具

1. **翻译管理**：Crowdin、Lokalise
2. **代码检查**：ESLint i18n 插件
3. **提取文本**：`vue-i18n-extract`

这样您的 Nuxt 4 项目就具备了完整的国际化支持！